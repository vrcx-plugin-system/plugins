(()=>{var h=Object.defineProperty;var u=(g,e)=>h(g,"name",{value:e,configurable:!0});const d=class d extends CustomModule{constructor(){super({name:"Plugin Analyzer \u{1F50D}",description:"Analyzes plugin code and shows detailed metadata and statistics",authors:[{name:"Bluscream",description:"VRCX Plugin System Maintainer",userId:"usr_08082729-592d-4098-9a21-83c8dd37a844"}],tags:["Tool","Utility","Analysis"],required_dependencies:["dialog-api"]})}async load(){this.logger.log("Plugin Analyzer ready"),this.loaded=!0}async start(){if(this.dialogApi=await window.customjs.waitForModule("dialog-api"),!this.dialogApi){this.logger.error("Dialog API not found! Please enable the Dialog API plugin.");return}this.enabled=!0,this.started=!0,this.logger.log("Plugin Analyzer started")}async stop(){if(this.logger.log("Stopping Plugin Analyzer"),this.dialogApi){const e=this.dialogApi.getAllDialogIds();for(const o of e)o.startsWith("plugin-analysis-")&&this.dialogApi.destroyDialog(o)}await super.stop()}async analyzePlugin(e){if(!e){this.logger.warn("No URL provided for analysis"),this.logger.showWarning("Plugin URL not available");return}try{this.logger.log(`\u{1F50D} Analyzing plugin: ${e}`),this.logger.showInfo("Analyzing plugin code...");let o=null,s=null,t=null;if(window.customjs?.modules&&(t=window.customjs.modules.find(i=>i.metadata?.url===e),t&&this.logger.log(`\u2713 Found loaded module instance: ${t.metadata.name}`)),window.customjs?.repos){for(const i of window.customjs.repos){if(!i.getModules)continue;const r=i.getModules().find(p=>p.url===e);if(r){o=r,s=r.sourceUrl,this.logger.log(`\u2713 Found module in repository: ${i.url}`),this.logger.log(`  \u2192 Source URL: ${s||"Not available"}`);break}}o||this.logger.log("Module not found in any repository, using URL-only analysis")}const n=window.customjs.classes.CustomModule;if(!n?.fetchMetadata){this.logger.error("CustomModule.fetchMetadata not available"),this.logger.showError("Analysis feature not available");return}const l=await n.fetchMetadata(e);if(l){const i={...l,sourceUrl:s||l.sourceUrl,repoData:o,loadedModule:t,isLoaded:!!t,isStarted:t?.started||!1,isEnabled:t?.enabled||!1};this.logger.log("Plugin analysis complete",i),this.showAnalysisDialog(i)}else this.logger.error("Failed to extract metadata"),this.logger.showError("Failed to analyze plugin")}catch(o){this.logger.error("Error analyzing plugin:",o),this.logger.showError(`Analysis error: ${o.message}`)}}showAnalysisDialog(e){const o=`plugin-analysis-${Date.now()}`,s=this.buildAnalysisContent(e);this.dialogApi.registerDialog(o,{title:`\u{1F50D} Plugin Analysis: ${e.name||"Unknown"}`,content:s,width:"900px",modal:!0,closeOnClickModal:!0,closeOnPressEscape:!0,onClose:()=>{this.dialogApi.destroyDialog(o)}}).show(),this.logger.showSuccess("Analysis complete")}buildAnalysisContent(e){const o=document.createElement("div");o.style.cssText="padding: 0;";const s={Name:e.name,Description:e.description,Authors:e.authors?.map(n=>n.name).join(", ")||"Unknown",Build:e.build,"Class Name":e.className,URL:e.url};e.sourceUrl&&(s["Source URL"]=e.sourceUrl),e.repoData&&(e.repoData.id&&(s["Module ID"]=e.repoData.id),e.repoData.enabled!==void 0&&(s["Enabled by Default"]=e.repoData.enabled?"Yes":"No")),e.isLoaded?s.Status=e.isStarted?e.isEnabled?"\u2713 Running":"Stopped":"Loaded (not started)":s.Status="Not loaded";const t=[{title:"Basic Information",data:s},{title:"Code Metrics",data:{Size:e.sizeFormatted,"Line Count":e.lineCount,"Function Count":e.functionCount,"Event Handlers":e.eventHandlerCount}},{title:"Settings",data:{"Settings Count":e.settingsCount,"Categories Count":e.categoriesCount}},{title:"Resource Registrations",data:{Observers:e.observerCount,Listeners:e.listenerCount,Subscriptions:e.subscriptionCount,Hooks:e.hookCount,Timers:e.timerCount}},{title:"Lifecycle Methods",data:{"Has load()":e.lifecycle?.hasLoad?"\u2713":"\u2717","Has start()":e.lifecycle?.hasStart?"\u2713":"\u2717","Has stop()":e.lifecycle?.hasStop?"\u2713":"\u2717","Has onLogin()":e.lifecycle?.hasOnLogin?"\u2713":"\u2717"}},{title:"External APIs",data:{AppApi:e.externalApis?.usesAppApi?"\u2713":"\u2717",Pinia:e.externalApis?.usesPinia?"\u2713":"\u2717","Vue Router":e.externalApis?.usesVueRouter?"\u2713":"\u2717","VRCX API":e.externalApis?.usesVRCXAPI?"\u2713":"\u2717","Web API":e.externalApis?.usesWebAPI?"\u2713":"\u2717"}},{title:"Resource Usage",data:{"Creates DOM":e.resourceUsage?.createsDomElements?"\u2713":"\u2717","Modifies DOM":e.resourceUsage?.modifiesDom?"\u2713":"\u2717",localStorage:e.resourceUsage?.usesLocalStorage?"\u2713":"\u2717",sessionStorage:e.resourceUsage?.usesSessionStorage?"\u2713":"\u2717",WebSocket:e.resourceUsage?.usesWebSocket?"\u2713":"\u2717"}}];if(e.tags&&e.tags.length>0&&t.push({title:"Tags",data:{"Tag List":e.tags.join(", ")}}),e.dependencies&&e.dependencies.length>0&&t.push({title:"Dependencies",data:{"Dependency Count":e.dependencies.length}}),t.forEach(n=>{const l=this.createAnalysisSection(n.title,n.data);o.appendChild(l)}),e.sourceCode){const n=document.createElement("div");n.style.cssText="margin-top: 20px;";const l=document.createElement("h4");l.style.cssText="margin: 0 0 10px 0; color: #409eff; font-size: 14px; text-transform: uppercase;",l.textContent="Source Code";const i=document.createElement("pre");i.style.cssText=`
        background: #1e1e1e;
        padding: 15px;
        border-radius: 4px;
        overflow-x: auto;
        max-height: 400px;
        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
        font-size: 12px;
        color: #d4d4d4;
        line-height: 1.5;
      `,i.textContent=e.sourceCode,n.appendChild(l),n.appendChild(i),o.appendChild(n)}return o}createAnalysisSection(e,o){const s=document.createElement("div");s.style.cssText="margin-bottom: 15px;";const t=document.createElement("h4");t.style.cssText="margin: 0 0 8px 0; color: #409eff; font-size: 14px; text-transform: uppercase;",t.textContent=e;const n=document.createElement("div");return n.style.cssText=`
      display: grid;
      grid-template-columns: 200px 1fr;
      gap: 8px;
      font-size: 13px;
    `,Object.entries(o).forEach(([l,i])=>{if(i==null)return;const c=document.createElement("div");c.style.cssText="color: #909090; font-weight: 500;",c.textContent=l+":";const r=document.createElement("div");r.style.cssText="color: #e0e0e0;",r.textContent=String(i),n.appendChild(c),n.appendChild(r)}),s.appendChild(t),s.appendChild(n),s}};u(d,"PluginAnalyzerPlugin");let a=d;window.customjs.__LAST_PLUGIN_CLASS__=a;})();
