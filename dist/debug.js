(()=>{var P=Object.defineProperty;var g=(v,e)=>P(v,"name",{value:e,configurable:!0});const w=class w extends CustomModule{constructor(){super({name:"\u{1F41B} Debug Plugin",description:"Debug utilities, IPC logging, global scope search, and console commands for development",authors:[{name:"Bluscream"}],dependencies:[]})}async load(){window.customjs.debug={printDebugInfo:()=>this.printDebugInfo(),listPlugins:()=>this.listPlugins(),getPlugin:e=>this.getPlugin(e),listEvents:()=>this.listEvents(),listHooks:()=>this.listHooks(),testEvent:(e,o)=>this.testEvent(e,o),getCurrentUser:()=>window.$pinia?.user?.currentUser,getCurrentLocation:()=>window.$app?.lastLocation,getFriends:()=>window.$pinia?.user?.currentUser?.friends,getCustomTags:()=>window.$pinia?.user?.customUserTags,getStores:()=>window.$pinia,getUserTag:e=>window.customjs.getModule("tag-manager")?.getUserTag(e),clearProcessedMenus:()=>window.customjs.getModule("context-menu-api")?.clearProcessedMenus(),triggerRegistryEvent:e=>window.customjs.getModule("registry-overrides")?.triggerEvent(e),refreshTags:()=>window.customjs.getModule("tag-manager")?.refreshTags(),getLoadedTagsCount:()=>window.customjs.getModule("tag-manager")?.getLoadedTagsCount(),getActiveTagsCount:()=>window.customjs.getModule("tag-manager")?.getActiveTagsCount(),getModules:()=>window.customjs.modules,getRepos:()=>window.customjs.repos,inspectPlugin:e=>this.inspectPlugin(e),searchVariable:(e,o)=>this.searchVariable(e,o)},this.logger.log("Debug utilities ready"),this.loaded=!0}async start(){this.setupIPCLogging(),this.enabled=!0,this.started=!0,this.logger.log("Debug plugin started (access via window.customjs.debug)"),this.printDebugInfo()}setupIPCLogging(){this.registerPreHook("AppApi.SendIpc",e=>{console.log("[IPC OUT]",e)}),this.logger.log("IPC logging hook registered (will activate when function available)")}async stop(){this.logger.log("Stopping Debug plugin"),window.customjs?.debug&&delete window.customjs.debug,await super.stop()}printDebugInfo(){this.logger.log("=== DEBUG INFO ==="),this.logger.log(`Modules loaded: ${window.customjs.modules.length}`),this.logger.log(`Events registered: ${Object.keys(window.customjs.events).length}`),this.logger.log(`Hooks registered: pre=${Object.keys(window.customjs.hooks.pre).length}, post=${Object.keys(window.customjs.hooks.post).length}`),this.logger.log(`Functions backed up: ${Object.keys(window.customjs.functions).length}`),window.customjs.modules.forEach(e=>{this.logger.log(`  - ${e.metadata.name} (build: ${e.metadata.build}) (${e.enabled?"enabled":"disabled"}, ${e.loaded?"loaded":"not loaded"}, ${e.started?"started":"not started"})`)})}listPlugins(){return window.customjs.modules.map(e=>({id:e.metadata.id,name:e.metadata.name,build:e.metadata.build,enabled:e.enabled,loaded:e.loaded,started:e.started}))}getPlugin(e){return window.customjs.getModule(e)}listEvents(){window.AppApi?.ShowDevTools&&window.AppApi.ShowDevTools();const e=window.customjs?.events||{};return console.group("Custom Events"),Object.keys(e).forEach(o=>{console.log(`${o}: ${e[o].length} listeners`)}),console.groupEnd(),e}listHooks(){return window.AppApi?.ShowDevTools&&window.AppApi.ShowDevTools(),console.group("Registered Hooks"),console.log("Pre-hooks:"),console.dir(Object.keys(window.customjs?.hooks?.pre||{})),console.log("Post-hooks:"),console.dir(Object.keys(window.customjs?.hooks?.post||{})),console.log("Void-hooks:"),console.dir(Object.keys(window.customjs?.hooks?.void||{})),console.log("Replace-hooks:"),console.dir(Object.keys(window.customjs?.hooks?.replace||{})),console.groupEnd(),window.customjs?.hooks}testEvent(e,o){this.emit(e,o),this.logger.log(`Emitted event: ${e}`,o)}inspectPlugin(e){window.AppApi?.ShowDevTools&&window.AppApi.ShowDevTools();const o=window.customjs?.modules?.find(i=>i.metadata.id===e);return o?(console.group(`Plugin: ${o.metadata.name}`),console.log("Metadata:"),console.dir(o.metadata),console.table({enabled:o.enabled,loaded:o.loaded,started:o.started}),console.log("Resources:"),console.dir(o.resources),console.groupEnd()):console.warn(`Plugin not found: ${e}`),o}searchVariable(e,o={}){const i=o.maxDepth||5,h=o.caseSensitive||!1,j=o.exactMatch||!1,$=o.root||window,a=[],p=new WeakSet,m=h?e:e.toLowerCase(),f=g((t,y,d)=>{if(!(d>i)&&t!=null&&!(typeof t!="object"&&typeof t!="function")&&!p.has(t)){p.add(t);try{const b=Object.getOwnPropertyNames(t);for(const n of b)try{const c=y?`${y}.${n}`:n,k=h?n:n.toLowerCase();if(j?k===m:k.includes(m)){let s,r;try{const l=Object.getOwnPropertyDescriptor(t,n);l&&l.get&&!l.set?(s="[Getter]",r="getter"):(s=t[n],r=typeof s)}catch{s="[Access Error]",r="error"}a.push({path:c,key:n,type:r,value:s})}if(d<i)try{const s=t[n];s&&(typeof s=="object"||typeof s=="function")&&f(s,c,d+1)}catch{}}catch{}}catch{}}},"search");return this.logger.log(`Searching for "${e}" (max depth: ${i})...`),f($,"",0),window.AppApi?.ShowDevTools&&window.AppApi.ShowDevTools(),console.group(`Search results for "${e}" (${a.length} matches)`),a.forEach(t=>{t.type==="getter"||t.type==="error"?console.log(`${t.path} [${t.type}]`):console.log(`${t.path} [${t.type}]`,t.value)}),console.groupEnd(),this.logger.log(`Found ${a.length} matches for "${e}"`),a}};g(w,"DebugPlugin");let u=w;window.customjs.__LAST_PLUGIN_CLASS__=u;})();
